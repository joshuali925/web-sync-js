<!DOCTYPE html>
<div class="container-fluid w-75 mt-3" style="min-width: 410px">
  <h3 class="text-muted" id="heading">&nbsp;</h3>
  <small class="text-muted" id="date-heading">&nbsp;</small>
  <textarea class="form-control mt-2" readonly style="height: 70vh"></textarea>
</div>
<div class="modal" role="dialog" id="deleteSavedModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Delete</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p id="modal-confirm-message"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          Cancel
        </button>
        <button
          type="button"
          class="btn btn-danger"
          onclick="deleteSaved(event)"
        >
          Delete
        </button>
      </div>
    </div>
  </div>
</div>
<script>
  $(document).ready(function () {
    fetch(
      "/api/save/" +
        window.location.pathname.substring(
          window.location.pathname.lastIndexOf("/") + 1
        )
    )
      .then((resp) => resp.json())
      .then((resp) => {
        $("textarea").text(resp.value);
          $("#heading").text(resp.description || "Saved Content");
        const date = moment.utc(resp.dateCreated);
        const dateElement = document.getElementById("date-heading")
        dateElement.textContent = "Created " + date.fromNow();
        dateElement.setAttribute(
          "title",
          date.local().format("YYYY-MM-DD HH:mm:ss")
        );
      });
    $("#deleteSavedModal").on("show.bs.modal", function (event) {
      const key = $(event.relatedTarget).data("key");
      $("#modal-confirm-message").text(`Are you sure to delete /${key}?`);
    });
  });
</script>

